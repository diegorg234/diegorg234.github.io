<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ruleta Aleatoria</title>
<style>
    body {
        font-family: Arial, sans-serif;
        background: #1e1e1e;
        color: white;
        display: flex;
        flex-direction: column;
        align-items: center;
        padding: 20px;
    }
    .container {
        width: 350px;
        text-align: center;
    }
    input {
        width: 100%;
        padding: 10px;
        margin: 10px 0;
        border-radius: 8px;
        border: none;
        outline: none;
    }
    button {
        width: 100%;
        padding: 10px;
        margin: 5px 0;
        border: none;
        border-radius: 8px;
        background: #ff4757;
        color: white;
        cursor: pointer;
        transition: 0.2s;
        font-size: 16px;
    }
    button:hover { background: #e84118; }
    #lista {
        margin-top: 15px;
        background: #2f3542;
        padding: 10px;
        border-radius: 8px;
        min-height: 40px;
    }
    #ruleta-container {
        margin-top: 30px;
        position: relative;
    }
    #flecha {
        width: 0;
        height: 0;
        border-left: 15px solid transparent;
        border-right: 15px solid transparent;
        border-bottom: 30px solid yellow;
        position: absolute;
        top: -35px;
        left: 50%;
        transform: translateX(-50%);
        z-index: 10;
    }
    #ruleta {
        border-radius: 50%;
        background: white;
    }
    #resultado {
        margin-top: 20px;
        font-size: 20px;
        font-weight: bold;
        color: #ffdd59;
    }
</style>
</head>
<body>

<div class="container">
    <h2>Ruleta Aleatoria</h2>

    <input id="nombre" type="text" placeholder="Escribe un nombre...">
    <button onclick="agregar()">Agregar</button>
    <button onclick="borrarLista()">Borrar lista</button>

    <div id="lista"></div>

    <button onclick="girar()">Girar Ruleta</button>
   <a href="portafolios.html" class="btn-volver">⬅ Volver al portafolio</a>
    <div id="ruleta-container">
        <div id="flecha"></div>
        <canvas id="ruleta" width="300" height="300"></canvas>
    </div>

    <div id="resultado"></div>
</div>

<script>
let elementos = [];
let ruleta = document.getElementById("ruleta");
let ctx = ruleta.getContext("2d");
let anguloActual = 0;

function dibujarRuleta() {
    let total = elementos.length;
    let anguloPorcion = (2 * Math.PI) / total;

    for (let i = 0; i < total; i++) {
        let angInicio = i * anguloPorcion;
        let angFinal = angInicio + anguloPorcion;

        ctx.beginPath();
        ctx.moveTo(150, 150);
        ctx.arc(150, 150, 150, angInicio, angFinal);
        ctx.fillStyle = `hsl(${(i * 360) / total}, 70%, 55%)`;
        ctx.fill();
        ctx.stroke();

        ctx.save();
        ctx.translate(150, 150);
        ctx.rotate(angInicio + anguloPorcion / 2);
        ctx.textAlign = "right";
        ctx.fillStyle = "black";
        ctx.font = "16px Arial";
        ctx.fillText(elementos[i], 130, 5);
        ctx.restore();
    }
}

function actualizarLista() {
    document.getElementById("lista").innerHTML = elementos.join(", ");
    ctx.clearRect(0, 0, 300, 300);
    if (elementos.length > 0) dibujarRuleta();
}

function agregar() {
    let nombre = document.getElementById("nombre").value.trim();
    if (nombre === "") return;

    if (elementos.includes(nombre)) {
        alert("Ese nombre ya está en la lista.");
        return;
    }

    elementos.push(nombre);
    document.getElementById("nombre").value = "";
    actualizarLista();
}

function borrarLista() {
    elementos = [];
    actualizarLista();
    document.getElementById("resultado").innerText = "";
}

function girar() {
    if (elementos.length === 0) return;

    let total = elementos.length;
    let anguloPorcion = (2 * Math.PI) / total;

    let ganador = Math.floor(Math.random() * total);
    let anguloGanador = ganador * anguloPorcion + anguloPorcion / 2;

    let rotacionFinal = (Math.PI * 8) + (2 * Math.PI - anguloGanador);
    let inicio = null;

    function animar(timestamp) {
        if (!inicio) inicio = timestamp;
        let progreso = (timestamp - inicio) / 3000;
        if (progreso >= 1) progreso = 1;

        anguloActual = rotacionFinal * progreso;

        ctx.save();
        ctx.clearRect(0, 0, 300, 300);
        ctx.translate(150, 150);
        ctx.rotate(anguloActual);
        ctx.translate(-150, -150);
        dibujarRuleta();
        ctx.restore();

        if (progreso < 1) {
            requestAnimationFrame(animar);
        } else {
            document.getElementById("resultado").innerText = "Ganador: " + elementos[ganador];
        }
    }

    requestAnimationFrame(animar);
}
</script>

</body>
</html>
